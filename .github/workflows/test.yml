name: push test branch # workflow ì´ë¦„

on: # ì´ë²¤íŠ¸ ê°ì§€
  push:
    branches:
      - test

jobs: # job id ì„¤ì •
  build: # job id
    runs-on: [ubuntu-latest] # job ê°€ìƒí™˜ê²½ ì¸ìŠ¤í„´ìŠ¤
    steps:
      - name: checkout sorce code
        uses: actions/checkout@master # usesë¥¼ í†µí•œ ì™¸ë¶€ ì„¤ì • ê°€ì ¸ì˜¤ê¸°(githun ê³µì‹ checkout ì•¡ì…˜ ì‚¬ìš©): ë ˆí¬ì§€í† ë¦¬ ì†ŒìŠ¤ ë°›ì•„ì˜¤ê¸°
      - name: Cache node_modules
        uses: actions/cache@v1.0.0 # github cache ì•¡ì…˜ ì‚¬ìš©
        # node_modules ìì²´ë¥¼ ìºì‹±í•˜ëŠ” ê²ƒì€ ê³µì‹ë¬¸ì„œì—ì„œ ì¶”ì²œí•˜ì§€ ì•Šì•˜ìŒ
        # it can break across Node versions and won't work with npm ci
        with:
          path: ~/.npm # ìºì‹œë¥¼ storeí•˜ê³  saveí•˜ëŠ” í´ë”. ì €ì¥í•˜ê³  ë¶ˆëŸ¬ì˜¬ ìºì‹œ ëŒ€ìƒ í´ë”
          key: ${{ runner.os }}-node-${{ hashFiles('**/package-lock.json') }} # ìºì‹œë¥¼ ë³µì›í•˜ê³  ì €ì¥í•˜ê¸°ìœ„í•œ ëª…ì‹œì  í‚¤
          restore-keys:
            | # (optional) ì¼ì¹˜í•˜ëŠ” ìºì‹œ keyê°€ ì—†ì„ ë•Œ ì°¨ì„ ìœ¼ë¡œ ìºì‹± í´ë”ë¥¼ ì°¾ê¸° ìœ„í•œ key
            ${{ runner.os }}-node-
      - name: npm install # step ì´ë¦„
        run: npm install # runì„ í†µí•œ ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰
      - name: run jest
        uses: stefanoeb/jest-action@1.0.0 # usesë¥¼ í†µí•œ ì™¸ë¶€ì„¤ì • ê°€ì ¸ì˜¤ê¸°
  slackNotification: # 2ë²ˆì§¸ job
    needs: [build] # build jobì´ ì™„ë£Œí•´ì•¼í•œë‹¤
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@master
      - name: Slack Notification
        uses: rtCamp/action-slack-notify@master
        env:
          SLACK_WEBHOOK: ${{ secrets.SLACK_WEBHOOK }}
          SLACK_CHANNEL: 16team
          SLACK_USERNAME: mergeBot
          SLACK_COLOR: good
          SLACK_TITLE: Message
          SLACK_MESSAGE: "ğŸ‰      ê²½           ì¶•      ğŸ‰\nì„±ê³µì ìœ¼ë¡œ PRì´ ë¨¸ì§€ë˜ì—ˆìŠµë‹ˆë‹¤!ğŸš€"
          SLACK_ICON: http://postfiles3.naver.net/MjAxOTExMDRfMTQx/MDAxNTcyODc0NDUwOTE2.cN6BwZom6d1WoLtHrbMerXxjxQ4P-w6e_qqM4A7Z4iMg.bxYDpY2XSOpGTwLlCx2T1mSs7_jvgp2388wL-CNI-QIg.JPEG.alineom/IMG_6594.jpg?type=w773
